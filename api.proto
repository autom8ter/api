syntax="proto3";

package api;

import "google/api/annotations.proto";

service UtilityService {
    rpc Echo(Message) returns (Message) {
        option (google.api.http) = {
      post: "/utility/echo"
      body: "*"
    };
    }
    rpc EchoSpanish(Message) returns (Message) {
        option (google.api.http) = {
      post: "/utility/echo/spanish"
      body: "*"
    };
    }
    rpc EchoChinese(Message) returns (Message) {
        option (google.api.http) = {
      post: "/utility/echo/chinese"
      body: "*"
    };
    }
    rpc EchoEnglish(Message) returns (Message) {
        option (google.api.http) = {
      post: "/utility/echo/english"
      body: "*"
    };
    }
    rpc EchoHindi(Message) returns (Message) {
        option (google.api.http) = {
      post: "/utility/echo/hindi"
      body: "*"
    };
    }
    rpc EchoArabic(Message) returns (Message) {
        option (google.api.http) = {
      post: "/utility/echo/arabic"
      body: "*"
    };
    }
    rpc MarshalJSON(Bytes) returns (Bytes) {
        option (google.api.http) = {
      post: "/utility/marshal/json"
      body: "*"
    };
    }
    rpc MarshalYAML(Bytes) returns (Bytes) {
        option (google.api.http) = {
      post: "/utility/marshal/yaml"
      body: "*"
    };
    }
    rpc MarshalXML(Bytes) returns (Bytes) {
        option (google.api.http) = {
      post: "/utility/marshal/xml"
      body: "*"
    };
    }
    rpc Render(Template) returns (Bytes) {
        option (google.api.http) = {
      post: "/utility/marshal/xml"
      body: "*"
    };
    }

}

service ContactService {
    rpc SendSMS(SMS) returns (Identifier) {
        option (google.api.http) = {
      post: "/contact/sms/{to}"
      body: "*"
    };
    }
    rpc GetSMS(Identifier) returns (SMSStatus) {
        option (google.api.http) = {
      post: "/contact/sms/{id}"
      body: "*"
    };
    }
    rpc SendEmail(EmailRequest) returns (Message) {
        option (google.api.http) = {
      post: "/contact/email/{email.address}"
      body: "*"
    };
    }
    rpc SendCall(Call) returns (Identifier) {
        option (google.api.http) = {
      post: "/contact/call/{to}"
      body: "*"
    };
    }
}

service UserService {
    rpc Subscribe(SubscribeRequest) returns (Identifier) {
        option (google.api.http) = {
      post: "/user/subscribe/{email}"
      body: "*"
    };
    }
    rpc Unsubscribe(UnSubscribeRequest) returns (Identifier) {
        option (google.api.http) = {
      post: "/user/unsubscribe/{email}"
      body: "*"
    };
    }
}

service AdminService {
    rpc GetDashboard(Secret) returns (Dashboard) {
        option (google.api.http) = {
      post: "/dashboard"
      body: "*"
    };
    }
}

message SubscribeRequest {
    string email=1;
    string plan =2;
    Card card =3;
}

message UnSubscribeRequest {
    string email=1;
    string plan =2;
}

message Card {
    string number=1;
    string exp_month=2;
    string exp_year =3;
    string cvc=4;
}

message Secret {
    string text =1;
}

message Empty {}

message Dashboard {
    UsersWidget users=1;
    CustomersWidget customers =2;
    PlansWidget plans=3;
    SubscriptionsWidget subscriptions=4;
    ChargesWidget charges=5;
}

message CustomersWidget {
    int64 count=1;
}

message PlansWidget {
    int64 count=1;
}

message SubscriptionsWidget {
    int64 count=1;
}

message ChargesWidget {
    int64 count=1;
    double total =2;
    double dollars_per_charge =3;
}

message UsersWidget {
    int64 count=1;
}

message Identifier {
    string id=1;
}

message SMSStatus {
    Identifier id=1;
    SMS sms =2;
    string status=3;
    string uri =4;
}

message SMS {
    string service =1;
    string to =2;
    Message message=3;
    string mediaURL =4;
    string callback=5;
    string app=6;
}

message EmailRequest {
    string from_name =1;
    string from_email =2;
    Email email =3;
}

message Email {
    string name =1;
    string address =2;
    string subject =3;
    string plain=4;
    string html=5;
}

message Call {
    string from=1;
    string to =2;
    string app=3;
}

message Message {
    string value = 1;
}

message UserInfo {
    string name=6;
    string given_name=7;
    string family_name=8;
    string gender =9;
    string birthdate=10;
    string email=11;
    string picture=12;
    UserMetadata user_metadata=13;
    AppMetadata app_metadata=14;

}

message UserMetadata {
    string phone =1;
    string preferred_contact=2;
    string status=3;
    repeated string tags=4;
}

message AppMetadata {
    string plan=1;
    string pay_token=2;
    string delinquent=3;
    repeated string tags=4;
}

message Auth {
    string domain =1;
    string client_id=2;
    string client_secret=3;
    string redirect=4;
    string audience=5;
    repeated string scopes=6;
}

message Bytes {
    bytes bits =1;
}

message Template {
    string text =1;
    bytes data =2;
}